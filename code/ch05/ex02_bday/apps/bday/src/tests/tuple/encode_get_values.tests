get_values_01_emulation_test() ->
    Expected = "zzz,yyy,xxx\r\nzzz,yyy,xxx",
    DeepTupleList =
        [[{"aaa", "zzz"}, {"bbb", "yyy"}, {"ccc", "xxx"}],
         [{"aaa", "zzz"}, {"bbb", "yyy"}, {"ccc", "xxx"}]],

    ListLists =
        [lists:map(fun(Elem) -> element(2, Elem) end, TupleList)
         || TupleList <- DeepTupleList],
    ValuesLists = [lists:join(",", List) || List <- ListLists],
    JoinedList = lists:join("\r\n", ValuesLists),
    ValuesString = lists:flatten(JoinedList),
    ?assertEqual(Expected, ValuesString).

get_values_02_test() ->
    Expected = "zzz,yyy,xxx\r\nzzz,yyy,xxx",
    DeepTupleList =
        [[{"aaa", "zzz"}, {"bbb", "yyy"}, {"ccc", "xxx"}],
         [{"aaa", "zzz"}, {"bbb", "yyy"}, {"ccc", "xxx"}]],

    ValuesString = get_csv_values(DeepTupleList),
    ?assertEqual(Expected, ValuesString).

encode_01_emulate_test() ->
    Expected = "aaa,bbb,ccc\r\nzzz,yyy,xxx\r\nzzz,yyy,xxx",
    DeepTupleList =
        [[{"aaa", "zzz"}, {"bbb", "yyy"}, {"ccc", "xxx"}],
         [{"aaa", "zzz"}, {"bbb", "yyy"}, {"ccc", "xxx"}]],

    KeysString = get_csv_keys(DeepTupleList),
    ValuesString = get_csv_values(DeepTupleList),
    Result = lists:flatten([KeysString, "\r\n", ValuesString]),
    ?assertEqual(Expected, Result).
